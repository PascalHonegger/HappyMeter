<div style="align-items: center;" *ngIf="activeEmotions && dailyEmotionalStates; else noDataTemplate" fxLayout="column" fxLayoutGap="20px">
  <h2 class="mat-display-1">Übersicht der heutigen Gefühlslage</h2>
  <ng-container *ngIf="dailyEmotionalStates.length === 0; else hasEmotionalStatesTemplate">
    <h3>Heute wurden noch keine Gefühlslagen erfasst</h3>
  </ng-container>
  <ng-template #hasEmotionalStatesTemplate>
    <h3>Heute wurden {{dailyEmotionalStates.length}} Gefühlslagen erfasst</h3>
    <div fxLayout="row" class="emotion-view-container" fxLayoutGap="20px">
      <div fxFlex="1 1 60%" fxLayoutAlign="center" fxLayout="row" fxLayoutGap="20px">
        <div [style.width.%]="relativeSize(emotion.id)" *ngFor="let emotion of activeEmotionsWithAtLeastOneEntry" [matTooltip]="amountOfEmotions(emotion.id)">
          <emoji-display [emojiCodePoint]="emotion.smileyCode"></emoji-display>
        </div>
      </div>
      <div fxFlex="1 1 40%" fxfLayout="column" style="align-items: center;" fxLayoutGap="5px" class="chat-history-container">
        <mat-card *ngFor="let comment of commentsWithEmotionAndTimestamp">
          <mat-card-header>
            <emoji-display mat-card-avatar class="emojiForComment" [emojiCodePoint]="comment.emojiCode"></emoji-display>
            <mat-card-title>
                {{comment.comment}}
            </mat-card-title>
            <mat-card-subtitle>
                {{comment.postDate | date}}
            </mat-card-subtitle>
          </mat-card-header>
          <mat-card-content>
            Keine Bewertungen
          </mat-card-content>
        </mat-card>
      </div>
    </div>
  </ng-template>
  <h2 class="mat-display-1">Wie fühlst Du dich?</h2>
  <div fxfLayout="row wrap" fxLayoutGap="20px">
    <button mat-raised-button class="select-emotion-button" [color]="selectedEmotionId == emotion.id ? 'primary' : 'default'" *ngFor="let emotion of activeEmotions" (click)="selectedEmotionId = emotion.id">
      <emoji-display [emojiCodePoint]="emotion.smileyCode"></emoji-display>
    </button>
  </div>
  <mat-form-field class="comment-input">
    <textarea matInput placeholder="Kommentar" [formControl]="commentFormControl" [(ngModel)]="comment" maxLength="250" [pattern]="pattern"></textarea>
    <mat-hint align="end">{{comment.length}} / 250</mat-hint>
    <mat-error *ngIf="commentFormControl.hasError('pattern')">
      Bitte keine ungewöhnlichen Zeichen verwenden
    </mat-error>
  </mat-form-field>
  <button mat-raised-button [disabled]="commentFormControl.invalid || selectedEmotionId == null || saveBlocked" (click)="sendEmotion()">
    Senden
  </button>
  <footer>
    <a routerLink="statistics">Statistiken</a> | <a routerLink="administration">Administration</a> | Emoji-Grafiken ermöglich durch <a href="https://twitter.github.io/twemoji/">Twemoji</a> | Umgesetzt von Pascal Honegger
  </footer>
</div>
<ng-template #noDataTemplate>
  Lade Daten...
</ng-template>
